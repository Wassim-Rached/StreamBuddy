<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      name="description"
      content="StreamBuddy: A simple and modern video calling application that allows users to share their camera or screen with others. Secure and user-friendly interface."
    />
    <meta name="author" content="Wassim Rached" />
    <title>StreamBuddy</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
    <link rel="icon" href="../../public/icon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/noty/lib/noty.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/noty/lib/themes/mint.css"
    />
    <link rel="stylesheet" href="../css/index.css" />
  </head>
  <body>
    <!-- <div id="connection-status" class="alert alert-info text-center mb-4">
      idle
    </div> -->
    <nav class="navbar navbar-light bg-light shadow-sm">
      <div class="container">
        <div
          id="connection-status"
          class="alert alert-info mb-0 mr-3 p-2"
          style="font-size: 0.875rem"
        >
          Idle
        </div>
        <a href="src/html/about.html" class="btn btn-primary">About</a>
      </div>
    </nav>

    <div class="container mt-4">
      <div id="alerts-container"></div>
      <div class="alert alert-warning text-center mb-4" role="alert">
        Warning: Sharing your ID with others allows them to call you. Please
        only share your ID with trusted individuals to avoid unwanted calls and
        potential privacy breaches. Always verify the identity of the caller
        before answering.
      </div>
      <div class="form-group mb-3">
        <label for="my-id" class="form-label">My ID: </label>
        <div class="input-group">
          <input disabled type="text" class="form-control" id="my-id" />
          <button
            class="btn btn-outline-secondary btn-custom"
            id="copy-btn"
            type="button"
          >
            Copy Link
          </button>
        </div>
      </div>
      <div class="form-group mb-3">
        <label for="peer-id" class="form-label">Peer ID: </label>
        <input type="text" class="form-control" id="peer-id" />
      </div>
      <div class="d-flex gap-2 mb-3">
        <button id="connect-btn" class="btn btn-sm btn-primary btn-custom">
          Connect
        </button>
        <button
          disabled
          id="hangup-btn"
          class="btn btn-sm btn-danger btn-custom"
        >
          Hangup
        </button>
      </div>

      <div class="mt-3">
        <hr />
        <div class="mt-4">
          <div class="d-flex justify-content-between gap-3 align-items-center">
            <!-- Audio Option -->
            <div class="form-check">
              <input
                type="checkbox"
                class="form-check-input"
                id="audio-checkbox"
              />
              <label class="form-check-label" for="audio-checkbox"
                >Microphone</label
              >
            </div>
            <div>
              <button
                id="audio-test-btn"
                class="btn btn-sm btn-outline-secondary btn-custom"
              >
                Test Audio
              </button>
              <button
                id="toogle-audio-settings"
                class="btn btn-sm btn-primary btn-custom"
              >
                Audio Settings
              </button>
            </div>
          </div>

          <div id="audio-settings" style="display: none">
            <div class="row mt-3">
              <div class="col-md-4 mb-3">
                <label for="noise-suppression-option" class="form-label">
                  Noise Suppression:
                </label>
                <select class="form-select" id="noise-suppression-option">
                  <option value="false">Off</option>
                  <option value="true">On</option>
                </select>
              </div>
              <div class="col-md-4 mb-3">
                <label for="echo-cancellation-option" class="form-label">
                  Echo Cancellation:
                </label>
                <select class="form-select" id="echo-cancellation-option">
                  <option value="false">Off</option>
                  <option value="true">On</option>
                </select>
              </div>
              <div class="col-md-4 mb-3">
                <label for="agc-option" class="form-label">
                  Auto Gain Control:
                </label>
                <select class="form-select" id="agc-option">
                  <option value="false">Off</option>
                  <option value="true">On</option>
                </select>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="audioDeviceInputOption" class="form-label">
                  Audio Source:
                </label>
                <select class="form-select" id="audio-device-input-option">
                  <option value="none">Nothing</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label for="audioDeviceOutputOption" class="form-label">
                  Audio Output:
                </label>
                <select class="form-select" id="audio-device-output-option">
                  <option value="none">Nothing</option>
                </select>
              </div>
            </div>
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="audio-input-volume" class="form-label"
                  >Microphone Volume:</label
                >
                <input
                  type="range"
                  class="form-range"
                  id="audio-input-volume"
                  min="0"
                  max="200"
                />
              </div>
              <div class="col-md-6 mb-3">
                <label for="audio-output-volume" class="form-label"
                  >Speaker Volume:</label
                >
                <input
                  type="range"
                  class="form-range"
                  id="audio-output-volume"
                  min="0"
                  max="100"
                  value="100"
                />
              </div>
            </div>
            <div class="row">
              <div class="col-md-4 mb-4">
                <div
                  class="d-flex flex-column align-items-center p-3 border rounded bg-light shadow-sm"
                >
                  <h5 class="mb-3">Local Audio</h5>
                  <canvas
                    id="local-stream-canvas"
                    class="w-100"
                    style="height: 150px"
                  ></canvas>
                </div>
              </div>
              <div class="col-md-4 mb-4">
                <div
                  class="d-flex flex-column align-items-center p-3 border rounded bg-light shadow-sm"
                >
                  <h5 class="mb-3">Test Audio</h5>
                  <canvas
                    id="test-stream-canvas"
                    class="w-100"
                    style="height: 150px"
                  ></canvas>
                </div>
              </div>
              <div class="col-md-4 mb-4">
                <div
                  class="d-flex flex-column align-items-center p-3 border rounded bg-light shadow-sm"
                >
                  <h5 class="mb-3">Remote Audio</h5>
                  <canvas
                    id="remote-stream-canvas"
                    class="w-100"
                    style="height: 150px"
                  ></canvas>
                </div>
              </div>
            </div>
          </div>

          <div class="row mt-3">
            <div class="col-md-3 mb-3">
              <label for="video-source-option" class="form-label"
                >Video Source:</label
              >
              <select class="form-select" id="video-source-option">
                <option value="none">Nothing</option>
                <option value="camera">Camera</option>
                <option value="screen">Screen</option>
              </select>
            </div>

            <div class="col-md-3 mb-3">
              <label for="video-device-input-option" class="form-label"
                >Video Input:</label
              >
              <select
                disabled
                class="form-select"
                id="video-device-input-option"
              >
                <option value="none">Select camera</option>
              </select>
            </div>

            <div class="col-md-3 mb-3">
              <label for="video-device-resolution-option" class="form-label"
                >Resolution:</label
              >
              <select
                disabled
                class="form-select"
                id="video-device-resolution-option"
              ></select>
            </div>

            <div class="col-md-3 mb-3">
              <label for="video-device-frame-rate-option" class="form-label"
                >Frame Rate:</label
              >
              <select
                disabled
                class="form-select"
                id="video-device-frame-rate-option"
              ></select>
            </div>
          </div>
        </div>
      </div>
      <div id="videos" class="d-flex gap-3 mt-4">
        <div class="video-container">
          <video id="local-video" playsinline autoplay></video>
        </div>
        <div class="video-container">
          <video id="remote-video" playsinline autoplay></video>
        </div>
      </div>
      <div class="chat-container mt-4">
        <div class="chat-box-container">
          <div class="chat-box" id="chat-box"></div>
          <div id="is-typing-indicator-container">
            <div id="is-typing-indicator">
              <span>is typing...</span>
            </div>
          </div>
        </div>
        <div class="input-group">
          <input
            disabled
            type="text"
            class="form-control"
            id="chat-message-input"
            placeholder="Type a message..."
          />
          <button disabled class="btn btn-primary" id="send-message-btn">
            Send
          </button>
        </div>
      </div>
      <div
        id="file-share"
        class="file-transfer-container mt-4 border rounded p-3 bg-light"
      >
        <h4 class="mb-3">File Transfer</h4>
        <div class="input-group mb-3">
          <input type="file" id="file-input" class="form-control" />
          <button class="btn btn-success btn-custom" id="send-file-btn">
            Send File
          </button>
        </div>
        <div id="file-list" class="mt-3">
          <!-- File list items will go here -->
        </div>
        <div class="container mt-4">
          <div class="border rounded p-3 mb-3">
            <h5 class="text-primary">Incoming File Requests</h5>
            <div id="incomming-file-requests-container" class="my-3"></div>
          </div>
          <div class="border rounded p-3 mb-3">
            <h5 class="text-primary">Incoming Files</h5>
            <div id="reciver-file-progress" class="mt-3 mb-3"></div>
          </div>
          <div class="border rounded p-3 mb-3">
            <h5 class="text-primary">Outgoing File Requests</h5>
            <div id="outgoing-file-requests-container" class="my-3"></div>
          </div>
          <div class="border rounded p-3 mb-3">
            <h5 class="text-primary">Outgoing Files</h5>
            <div id="sender-file-progress" class="mt-3 mb-3"></div>
          </div>
        </div>
      </div>
      <div id="calls">
        <h3 class="mt-4">Incoming Calls</h3>
        <div id="incomming-calls-container" class="d-flex">
          <div class="alert alert-info text-center mt-3" role="alert">
            No incoming calls at the moment.
          </div>
        </div>
        <h3 class="mt-4">Outgoing Calls</h3>
        <div id="outgoing-calls-container" class="d-flex">
          <div class="alert alert-info text-center mt-3" role="alert">
            No outgoing calls at the moment.
          </div>
        </div>
      </div>
    </div>
    <div id="footer"></div>
    <div>
      <!-- non displayed -->
      <audio id="local-audio" style="display: none" autoplay muted></audio>
      <audio id="test-audio" style="display: none" autoplay muted></audio>
      <audio id="remote-audio" style="display: none" autoplay></audio>
    </div>
    <!-- html based -->
    <script src="src/js/footer.js"></script>
    <!-- bootstrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- noty -->
    <script src="https://cdn.jsdelivr.net/npm/noty/lib/noty.min.js"></script>
    <!-- plyr -->
    <script src="https://cdn.plyr.io/3.7.8/plyr.polyfilled.js"></script>
    <!-- peerjs -->
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js"></script>
    <!-- scripts (order shouldn't matter) -->
    <script src="src/js/plyr.js" defer></script>
    <script src="src/js/videoShareUtils.js" defer></script>
    <script src="src/js/voiceShareUtils.js" defer></script>
    <script src="src/js/fileShareUtils.js" defer></script>
    <script src="src/js/utils.js" defer></script>
    <script src="src/js/main.js" defer></script>
  </body>
</html>
